import{_ as i,o as a,c as t,aA as n}from"./chunks/framework.BjnFN11a.js";const o=JSON.parse('{"title":"AD Backends","description":"","frontmatter":{},"headers":[],"relativePath":"manual/backends.md","filePath":"manual/backends.md","lastUpdated":null}'),e={name:"manual/backends.md"};function l(h,s,p,k,d,r){return a(),t("div",null,[...s[0]||(s[0]=[n(`<h1 id="AD-Backends" tabindex="-1">AD Backends <a class="header-anchor" href="#AD-Backends" aria-label="Permalink to &quot;AD Backends {#AD-Backends}&quot;">​</a></h1><p>QuantNova provides a flexible automatic differentiation (AD) backend system that allows you to choose the best differentiation engine for your use case. All backends provide the same API, making it easy to switch between them.</p><h2 id="Available-Backends" tabindex="-1">Available Backends <a class="header-anchor" href="#Available-Backends" aria-label="Permalink to &quot;Available Backends {#Available-Backends}&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:right;">Backend</th><th style="text-align:right;">Engine</th><th style="text-align:right;">Best For</th></tr></thead><tbody><tr><td style="text-align:right;"><code>ForwardDiffBackend()</code></td><td style="text-align:right;">ForwardDiff.jl</td><td style="text-align:right;">Default choice, low-dimensional problems, nested derivatives</td></tr><tr><td style="text-align:right;"><code>PureJuliaBackend()</code></td><td style="text-align:right;">Finite differences</td><td style="text-align:right;">Debugging, testing, reference implementation</td></tr><tr><td style="text-align:right;"><code>EnzymeBackend()</code></td><td style="text-align:right;">Enzyme.jl (LLVM)</td><td style="text-align:right;">Large-scale problems, reverse-mode, CPU/GPU</td></tr><tr><td style="text-align:right;"><code>ReactantBackend()</code></td><td style="text-align:right;">Reactant.jl (XLA)</td><td style="text-align:right;">GPU acceleration, high-dimensional optimization</td></tr></tbody></table><h2 id="Quick-Start" tabindex="-1">Quick Start <a class="header-anchor" href="#Quick-Start" aria-label="Permalink to &quot;Quick Start {#Quick-Start}&quot;">​</a></h2><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Default backend (ForwardDiff)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses ForwardDiff by default</span></span></code></pre></div><h2 id="Choosing-a-Backend" tabindex="-1">Choosing a Backend <a class="header-anchor" href="#Choosing-a-Backend" aria-label="Permalink to &quot;Choosing a Backend {#Choosing-a-Backend}&quot;">​</a></h2><h3 id="Per-Call-Selection" tabindex="-1">Per-Call Selection <a class="header-anchor" href="#Per-Call-Selection" aria-label="Permalink to &quot;Per-Call Selection {#Per-Call-Selection}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Explicit backend selection</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactantBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PureJuliaBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><h3 id="Global-Backend" tabindex="-1">Global Backend <a class="header-anchor" href="#Global-Backend" aria-label="Permalink to &quot;Global Backend {#Global-Backend}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Set global default</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_backend!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Now uses Enzyme</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check current backend</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">current_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Returns EnzymeBackend()</span></span></code></pre></div><h3 id="Scoped-Backend-Recommended" tabindex="-1">Scoped Backend (Recommended) <a class="header-anchor" href="#Scoped-Backend-Recommended" aria-label="Permalink to &quot;Scoped Backend (Recommended) {#Scoped-Backend-Recommended}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Temporarily use a different backend</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> with_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactantBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    hessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # All AD calls use Reactant here</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Original backend restored automatically</span></span></code></pre></div><h2 id="Backend-Details" tabindex="-1">Backend Details <a class="header-anchor" href="#Backend-Details" aria-label="Permalink to &quot;Backend Details {#Backend-Details}&quot;">​</a></h2><h3 id="ForwardDiffBackend-Default" tabindex="-1">ForwardDiffBackend (Default) <a class="header-anchor" href="#ForwardDiffBackend-Default" aria-label="Permalink to &quot;ForwardDiffBackend (Default) {#ForwardDiffBackend-Default}&quot;">​</a></h3><p>The default backend using forward-mode AD with dual numbers.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p><strong>Pros:</strong></p><ul><li><p>Most reliable, works with any Julia code</p></li><li><p>Efficient for low-dimensional inputs (n &lt; 100)</p></li><li><p>Supports nested derivatives (Hessians via forward-over-forward)</p></li><li><p>No compilation overhead</p></li></ul><p><strong>Cons:</strong></p><ul><li><p>O(n) cost scales with input dimension</p></li><li><p>Not optimal for high-dimensional problems</p></li></ul><p><strong>Best for:</strong> Options pricing, Greeks computation, small optimizations</p><h3 id="PureJuliaBackend" tabindex="-1">PureJuliaBackend <a class="header-anchor" href="#PureJuliaBackend" aria-label="Permalink to &quot;PureJuliaBackend {#PureJuliaBackend}&quot;">​</a></h3><p>Reference implementation using finite differences.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PureJuliaBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p><strong>Pros:</strong></p><ul><li><p>Works with absolutely any function</p></li><li><p>No AD-specific restrictions</p></li><li><p>Great for debugging other backends</p></li></ul><p><strong>Cons:</strong></p><ul><li><p>O(n) function evaluations</p></li><li><p>Lower numerical precision (~1e-7)</p></li><li><p>Slow for production use</p></li></ul><p><strong>Best for:</strong> Testing, debugging, validating other backends</p><h3 id="EnzymeBackend" tabindex="-1">EnzymeBackend <a class="header-anchor" href="#EnzymeBackend" aria-label="Permalink to &quot;EnzymeBackend {#EnzymeBackend}&quot;">​</a></h3><p>LLVM-based AD that works at the compiler level.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Must load Enzyme first</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Forward or reverse mode</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># default</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:forward</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><p><strong>Pros:</strong></p><ul><li><p>State-of-the-art performance</p></li><li><p>Works on CPU and GPU</p></li><li><p>Supports mutation and complex control flow</p></li><li><p>O(1) cost for reverse mode (independent of input dimension)</p></li></ul><p><strong>Cons:</strong></p><ul><li><p>Longer compilation times</p></li><li><p>Some operations not supported (RNG internals)</p></li><li><p>BLAS operations may show warnings</p></li></ul><p><strong>Best for:</strong> Large-scale optimization, portfolio problems, production systems</p><p><strong>Limitation - Random Number Generators:</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This will fail with Enzyme:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mc_price</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S0)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    paths </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">randn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RNG not differentiable</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mc_price</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]), [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Error!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Solution: Use QMC (automatic for mc_delta/mc_greeks)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mc_delta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S0, T, payoff, dynamics; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Works! Uses Sobol sequences</span></span></code></pre></div><h3 id="ReactantBackend" tabindex="-1">ReactantBackend <a class="header-anchor" href="#ReactantBackend" aria-label="Permalink to &quot;ReactantBackend {#ReactantBackend}&quot;">​</a></h3><p>XLA-based compilation for GPU acceleration.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Reactant  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Must load Reactant first</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactantBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p><strong>Pros:</strong></p><ul><li><p>GPU acceleration via XLA</p></li><li><p>Optimized for large batch operations</p></li><li><p>Automatic kernel fusion</p></li></ul><p><strong>Cons:</strong></p><ul><li><p>Compilation overhead on first call</p></li><li><p>Some reductions not supported (prod)</p></li><li><p>Requires Reactant.jl installation</p></li></ul><p><strong>Best for:</strong> High-dimensional portfolio optimization, batch pricing</p><p><strong>Limitation - Reductions:</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This will fail:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Multiply reduction not supported in reverse mode</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactantBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Error!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># These work fine:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.^</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sum reduction works</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactantBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OK</span></span></code></pre></div><h2 id="API-Reference" tabindex="-1">API Reference <a class="header-anchor" href="#API-Reference" aria-label="Permalink to &quot;API Reference {#API-Reference}&quot;">​</a></h2><h3 id="Core-Functions" tabindex="-1">Core Functions <a class="header-anchor" href="#Core-Functions" aria-label="Permalink to &quot;Core Functions {#Core-Functions}&quot;">​</a></h3><p>All backends support these functions with identical signatures:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Gradient of scalar function</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">current_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Vector</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Value and gradient in one pass</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">value_and_gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">current_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (value, gradient)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Hessian matrix</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hessian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">current_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Matrix</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Jacobian matrix</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">jacobian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">current_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Matrix</span></span></code></pre></div><h3 id="Backend-Management" tabindex="-1">Backend Management <a class="header-anchor" href="#Backend-Management" aria-label="Permalink to &quot;Backend Management {#Backend-Management}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Get/set global backend</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">current_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADBackend</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_backend!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ADBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ADBackend</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Scoped backend</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">with_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ADBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># GPU initialization</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">enable_gpu!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Auto-detect</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">enable_gpu!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:enzyme</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Force Enzyme</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">enable_gpu!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:reactant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Force Reactant</span></span></code></pre></div><h2 id="Monte-Carlo-Greeks" tabindex="-1">Monte Carlo Greeks <a class="header-anchor" href="#Monte-Carlo-Greeks" aria-label="Permalink to &quot;Monte Carlo Greeks {#Monte-Carlo-Greeks}&quot;">​</a></h2><p>Monte Carlo Greeks require special handling because standard RNGs are not differentiable. QuantNova automatically uses Quasi-Monte Carlo (Sobol sequences) when using Enzyme:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">S0, K, T, r, sigma </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dynamics </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> GBMDynamics</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(r, sigma)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">payoff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> EuropeanCall</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(K)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ForwardDiff: uses pseudo-random with fixed seed</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">delta_fd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mc_delta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S0, T, payoff, dynamics; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Enzyme: automatically uses QMC (Sobol sequences)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">delta_enz </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mc_delta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S0, T, payoff, dynamics; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Both give similar results</span></span></code></pre></div><h3 id="Direct-QMC-Access" tabindex="-1">Direct QMC Access <a class="header-anchor" href="#Direct-QMC-Access" aria-label="Permalink to &quot;Direct QMC Access {#Direct-QMC-Access}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># QMC pricing (deterministic, always reproducible)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> mc_price_qmc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(S0, T, payoff, dynamics; npaths</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Generate Sobol-based normal samples</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sobol_normals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nsteps, npaths)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Matrix of N(0,1) samples</span></span></code></pre></div><h2 id="Performance-Comparison" tabindex="-1">Performance Comparison <a class="header-anchor" href="#Performance-Comparison" aria-label="Permalink to &quot;Performance Comparison {#Performance-Comparison}&quot;">​</a></h2><p>Typical performance characteristics (varies by problem):</p><table tabindex="0"><thead><tr><th style="text-align:right;">Operation</th><th style="text-align:right;">ForwardDiff</th><th style="text-align:right;">Enzyme</th><th style="text-align:right;">Reactant</th></tr></thead><tbody><tr><td style="text-align:right;">Gradient (n=10)</td><td style="text-align:right;">1x</td><td style="text-align:right;">0.8x</td><td style="text-align:right;">2x (compilation)</td></tr><tr><td style="text-align:right;">Gradient (n=1000)</td><td style="text-align:right;">100x</td><td style="text-align:right;">1x</td><td style="text-align:right;">0.5x</td></tr><tr><td style="text-align:right;">Hessian (n=10)</td><td style="text-align:right;">1x</td><td style="text-align:right;">1.2x</td><td style="text-align:right;">1.5x</td></tr><tr><td style="text-align:right;">Compilation</td><td style="text-align:right;">None</td><td style="text-align:right;">~1s</td><td style="text-align:right;">~2s</td></tr></tbody></table><p><strong>Rule of thumb:</strong></p><ul><li><p>n &lt; 50: ForwardDiff</p></li><li><p>n &gt; 50, CPU: Enzyme</p></li><li><p>n &gt; 100, GPU available: Reactant</p></li></ul><h2 id="Troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#Troubleshooting" aria-label="Permalink to &quot;Troubleshooting {#Troubleshooting}&quot;">​</a></h2><h3 id="EnzymeBackend-requires-Enzyme.jl-to-be-loaded" tabindex="-1">&quot;EnzymeBackend requires Enzyme.jl to be loaded&quot; <a class="header-anchor" href="#EnzymeBackend-requires-Enzyme.jl-to-be-loaded" aria-label="Permalink to &quot;&amp;quot;EnzymeBackend requires Enzyme.jl to be loaded&amp;quot; {#&quot;EnzymeBackend-requires-Enzyme.jl-to-be-loaded&quot;}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load Enzyme before using EnzymeBackend</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Enzyme</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Now works</span></span></code></pre></div><h3 id="ReactantBackend-requires-Reactant.jl-to-be-loaded" tabindex="-1">&quot;ReactantBackend requires Reactant.jl to be loaded&quot; <a class="header-anchor" href="#ReactantBackend-requires-Reactant.jl-to-be-loaded" aria-label="Permalink to &quot;&amp;quot;ReactantBackend requires Reactant.jl to be loaded&amp;quot; {#&quot;ReactantBackend-requires-Reactant.jl-to-be-loaded&quot;}&quot;">​</a></h3><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Reactant</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QuantNova</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, x; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReactantBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Now works</span></span></code></pre></div><h3 id="Enzyme-RNG-Error" tabindex="-1">Enzyme RNG Error <a class="header-anchor" href="#Enzyme-RNG-Error" aria-label="Permalink to &quot;Enzyme RNG Error {#Enzyme-RNG-Error}&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>EnzymeNoDerivativeError: No augmented forward pass found for dsfmt_fill_array</span></span></code></pre></div><p>Your function uses <code>randn()</code> or similar. Use QMC functions or ForwardDiff:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Option 1: Use ForwardDiff for MC</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mc_delta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Option 2: Use QMC-based functions (automatic for Enzyme)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mc_delta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EnzymeBackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Uses Sobol internally</span></span></code></pre></div><h3 id="Reactant-prod-Error" tabindex="-1">Reactant prod() Error <a class="header-anchor" href="#Reactant-prod-Error" aria-label="Permalink to &quot;Reactant prod() Error {#Reactant-prod-Error}&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Unsupported operation in reduction rev autodiff: stablehlo.multiply</span></span></code></pre></div><p>Reactant doesn&#39;t support <code>prod()</code> in reverse mode. Rewrite using logs:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Instead of:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(x)))</span></span></code></pre></div><h2 id="Backend-Compatibility-Matrix" tabindex="-1">Backend Compatibility Matrix <a class="header-anchor" href="#Backend-Compatibility-Matrix" aria-label="Permalink to &quot;Backend Compatibility Matrix {#Backend-Compatibility-Matrix}&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:right;">Feature</th><th style="text-align:right;">ForwardDiff</th><th style="text-align:right;">PureJulia</th><th style="text-align:right;">Enzyme</th><th style="text-align:right;">Reactant</th></tr></thead><tbody><tr><td style="text-align:right;">gradient</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td></tr><tr><td style="text-align:right;">value_and_gradient</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td></tr><tr><td style="text-align:right;">hessian</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅*</td></tr><tr><td style="text-align:right;">jacobian</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅*</td></tr><tr><td style="text-align:right;">mc_delta</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅ (QMC)</td><td style="text-align:right;">❌</td></tr><tr><td style="text-align:right;">mc_greeks</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅ (QMC)</td><td style="text-align:right;">❌</td></tr><tr><td style="text-align:right;">GPU</td><td style="text-align:right;">❌</td><td style="text-align:right;">❌</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td></tr><tr><td style="text-align:right;">prod()</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">❌</td></tr><tr><td style="text-align:right;">RNG</td><td style="text-align:right;">✅</td><td style="text-align:right;">✅</td><td style="text-align:right;">❌</td><td style="text-align:right;">❌</td></tr></tbody></table><p>*Reactant hessian/jacobian use Enzyme internally</p>`,82)])])}const c=i(e,[["render",l]]);export{o as __pageData,c as default};
